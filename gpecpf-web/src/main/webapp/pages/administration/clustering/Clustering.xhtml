<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/templates/templateAdmin.xhtml"
                xmlns:a="http://elit.dz/ui"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core">

    <ui:define name="Title">
        #{bundleCommun.titre_clustering}
    </ui:define>

    <ui:define name="breadCrumb"> 
        <a:breadcrumb>
            <a:menuitem value="#{bundleCommun.titre_clustering}" />
            <a:menuitem value="#{bundleCommun.titre_cluster}" href="Clustering.xhtml" last="true"/>
        </a:breadcrumb>
    </ui:define>

    <ui:define name="MyContent">
        <h:form id="Form_G">
            <a:row>
                <a:pagetitle value="Clustering" />
                <p:messages id="msgs" globalOnly="true" showDetail="true" closable="true"/>                
            </a:row>

            <a:row>
                <a:panel header=" #{bundleAdmin.find_cluster}" iconheader="fa fa-list-ul">
                    <a:row>
                        <a:column span="12">
                            <h:panelGrid columns="5" id="idPanelCluster">
                                <a:label value="#{bundleAdmin.lbl_ipcluster}"/>
                                <p:spacer height="20"/>
                                <p:inputText id="ipadress" required="true" requiredMessage="@IP du serveur est obligatoire"
                                             value="#{clustering.ipadress}"/>
                                <p:spacer height="20"/>        
                                <p:commandButton value="#{bundleAdmin.btn_find_cluster}" actionListener="#{clustering.findClusters()}" 
                                                 update=":Form_G:idListClustersTab" id="idFindClusterB"/>
                                <p:blockUI block=":Form_G" trigger="idFindClusterB">
                                    Take a coffé..<br />
                                    <p:graphicImage value="../../../resources/images/images-loading/loading.gif"/>
                                </p:blockUI>
                            </h:panelGrid>
                        </a:column>
                    </a:row>
                </a:panel>
            </a:row>
            <a:row>
                <a:panel header=" #{bundleAdmin.liste_clusters}" iconheader="fa fa-list-ul">
                    <p:dataTable id="idListClustersTab" var="VarCluster" reflow="true"
                                 value="#{clustering.listeClusters}" widgetVar="wListClustersTab" 
                                 emptyMessage="Liste vide" resizableColumns="true" >
                        <p:column sortBy="#{VarCluster.host}">
                            <f:facet name="header">
                                <h:outputText value="Code"/>
                            </f:facet>
                            <h:outputText value="#{VarCluster.host}"/>
                        </p:column>
                        <p:column sortBy="#{VarCluster.statut}">
                            <f:facet name="header">
                                <h:outputText value="Statut"/>
                            </f:facet>
                            <h:outputText value="#{VarCluster.statut}"/>
                        </p:column>
                        <p:column style="width: 25%">
                            <f:facet name="header">
                                <h:outputText value="Actions"/>
                            </f:facet>
                            <p:commandButton value="start" actionListener="#{clustering.startCluster()}" 
                                             style="color: green !important;" id="idStartCluster">
                                <f:setPropertyActionListener value="#{VarCluster}" target="#{clustering.cluster}" />
                            </p:commandButton>
                            <p:commandButton value="stop" actionListener="#{clustering.stopCluster()}"
                                             style="color: red !important;" id="idStopCluster">
                                <f:setPropertyActionListener value="#{VarCluster}" target="#{clustering.cluster}" />
                            </p:commandButton>
                            <p:commandButton value="Find Instances" actionListener="#{clustering.findInstances()}"
                                             update=":Form_G:idListInstanceTab" style="color: blue !important;" 
                                             id="idFindInstanceB">
                                <f:setPropertyActionListener value="#{VarCluster}" target="#{clustering.cluster}"/>
                            </p:commandButton>
                            <p:blockUI block=":Form_G" trigger="idFindInstanceB, idStopCluster, idStartCluster">
                                Take a coffé..<br />
                                <p:graphicImage value="../../../resources/images/images-loading/loading.gif"/>
                            </p:blockUI>
                        </p:column>
                    </p:dataTable>
                </a:panel>
            </a:row>
            <a:row>
                <a:panel header=" #{bundleAdmin.liste_clusters}" iconheader="fa fa-list-ul">
                    <p:dataTable id="idListInstanceTab" var="VarInstance" 
                                 value="#{clustering.listeInstances}" widgetVar="wListInstanceTab" 
                                 emptyMessage="Liste vide" resizableColumns="true" >
                        <p:column sortBy="#{VarInstance.name}">
                            <f:facet name="header">
                                <h:outputText value="Name"/>
                            </f:facet>
                            <h:outputText value="#{VarInstance.name}"/>
                        </p:column>
                        <p:column sortBy="#{VarInstance.host}">
                            <f:facet name="header">
                                <h:outputText value="Host"/>
                            </f:facet>
                            <h:outputText value="#{VarInstance.host}"/>
                        </p:column>
                        <p:column sortBy="#{VarInstance.port}">
                            <f:facet name="header">
                                <h:outputText value="Port"/>
                            </f:facet>
                            <h:outputText value="#{VarInstance.port}"/>
                        </p:column>
                        <p:column sortBy="#{VarInstance.statut}">
                            <f:facet name="header">
                                <h:outputText value="Statut"/>
                            </f:facet>
                            <h:outputText value="#{VarInstance.statut}"/>
                        </p:column>
                        <p:column style="width: 150px;;">
                            <f:facet name="header">
                                <h:outputText value="Actions"/>
                            </f:facet>
                            <p:commandButton value="start" actionListener="#{clustering.startInstance(VarInstance)}" 
                                             update="idListInstanceTab" id="isStartInstanceB" 
                                             style="color: green !important;"/>
                            <p:commandButton value="stop" actionListener="#{clustering.stopInstance(VarInstance)}" 
                                             update="idListInstanceTab" id="idStopInstanceB" 
                                             style="color: red !important;"/>
                            <p:blockUI block=":Form_G" trigger="isStartInstanceB, idStopInstanceB">
                                Take a coffé..<br />
                                <p:graphicImage value="../../../resources/images/images-loading/loading.gif"/>
                            </p:blockUI>
                        </p:column>
                    </p:dataTable>
                </a:panel>
            </a:row>
        </h:form>
    </ui:define>

    <ui:define name="MyDialog">
        MyDialog
    </ui:define>

</ui:composition>